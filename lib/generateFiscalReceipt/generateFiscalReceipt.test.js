import generateFiscalReceipt from "./generateFiscalReceipt.js";
import receiptConfig from "../../config/receiptConfig.js";
import {
  cashboxConfig,
  orderInfo,
  productsInfo,
  taxesInfo,
  paymentInfo,
  bankInfo,
  footerInfo,
} from "../../mock.js";

describe("generateFiscalReceipt", () => {
  it("should has this structure", async () => {
    const expectedReceipt = [
      "            СГ ТОВ ТЕСТ ПРРО            ",
      '              Кафе "Мʼята"              ',
      "  Дніпропетровська область, м. Дніпро,  ",
      "   Амур-Нижньодніпровський район, вул.  ",
      "    Шолом-Алейхема, 4, кв. (Офіс) 31    ",
      "               ІД 12345678              ",
      "Чек №           1650                    ",
      "Тип замовлення  У закладі               ",
      "Відкрито        16 травня 2024 19:28:35 ",
      "Надруковано     16 травня 2024 19:29:35 ",
      "Стіл №          1 (Зал 1)               ",
      "К-сть гостей    2                       ",
      "",
      "----------------------------------------",
      "2204109600#    2 x   130,02   2     ДГ",
      "12345678                              ",
      "ADCC123123 Вино                       ",
      "2204888600#    4 x   260,00   2      Д",
      "Сир                                   ",
      "",
      "----------------------------------------",
      "Сума ........................ 1300,04грн",
      "ПДВ 20% ...................... 214,60грн",
      "Акциз 5% ...................... 12,38грн",
      "----------------------------------------",
      "Готівкою ..................... 200,00грн",
      "Карткою ..................... 1100,00грн",
      "До сплати ................... 1300,00грн",
      "Заокруглення ................... 0,04грн",
      "",
      "----------------------------------------",
      "ПриватБанк                              ",
      "S1260S6Y                                ",
      "Оплата                                  ",
      "ЕПЗ                     1234********5678",
      "ПЛАТІЖНА СИСТЕМА              MASTERCARD",
      "КОД АВТ.                          199016",
      "RRN                         082699265208",
      "КАСИР                         ..........",
      "ДЕРЖАТЕЛЬ ЕПЗ                 ..........",
      "",
      "----------------------------------------",
      "      Вас очикує приємний сюрприз!      ",
      "                                        ",
      "               ІД 12345678              ",
      "         16 травня 2024 19:29:35        ",
      "               4000244601               ",
      "                 ОНЛАЙН                 ",
      "             ФІСКАЛЬНИЙ ЧЕК             ",
      "               Poster POS               ",
    ].join("\n");
    expect(
      await generateFiscalReceipt({
        cashboxConfig,
        receiptConfig,
        orderInfo,
        productsInfo,
        taxesInfo,
        paymentInfo,
        bankInfo,
        footerInfo,
      }),
    ).toEqual(expectedReceipt);
  });
});
